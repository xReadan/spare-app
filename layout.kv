<DrawerClickableItem@MDNavigationDrawerItem>
    focus_color: "#232D3F"
    text_color: "#008170"
    icon_color: "#008170"
    ripple_color: "#c5bdd2"
    selected_color: "#005B41"

<MDNavigationDrawerLabel@MDNavigationDrawerItem>
    md_bg_color: "#005B41"
    padding: [12, 6, 12, 6]
    margin: [0, 0, 0, 6]
    radius: 12
    spacing: "4dp"

<ContentNavigationDrawer>
    MDNavigationDrawerMenu:
        MDNavigationDrawerHeader:
            id: menu_header
            title: "SpareApp"
            title_color: "#FFFFFF"
            text: "v0.1"
            text_color: "#005B41"
            spacing: "4dp"
            padding: "12dp", 0, 0, "12dp"

        MDNavigationDrawerDivider:

        MDNavigationDrawerLabel:
            text: "Home"
        DrawerClickableItem:
            icon: "view-dashboard"
            text: "Dashboard"
            on_press:
                root.nav_drawer.set_state("close")
                root.screen_manager.transition.direction = "left"
                root.screen_manager.current = 'Dashboard'
        DrawerClickableItem:
            icon: "cart"
            text: "Add Expense"
            on_press:
                root.nav_drawer.set_state("close")
                root.screen_manager.transition.direction = "left"
                root.screen_manager.current = 'Add Expenses'
        
        MDNavigationDrawerDivider:

        MDNavigationDrawerLabel:
            text: "Manage"
        DrawerClickableItem:
            icon: "cash-multiple"
            text: "Manage Incomes"
            on_press:
                root.nav_drawer.set_state("close")
                root.screen_manager.transition.direction = "left"
                root.screen_manager.current = 'Manage Incomes' 
        DrawerClickableItem:
            icon: "shape"
            text: "Manage Categories"
            on_press:
                root.nav_drawer.set_state("close")
                root.screen_manager.transition.direction = "left"
                root.screen_manager.current = 'Manage Categories'
        DrawerClickableItem:
            icon: "finance"
            text: "Check Expenses"
            on_press:
                root.nav_drawer.set_state("close")
                root.screen_manager.transition.direction = "left"
                root.screen_manager.current = 'Check Expenses'

<PasswordField>
    size_hint_y: None
    height: password.height
    MDTextField:
        id: password
        hint_text: root.hint_text
        text: root.text
        password: True
        icon_left: "key-variant"

    MDIconButton:
        icon: "eye-off"
        pos_hint: {"center_y": .5}
        pos: password.width - self.width + dp(8), 0
        on_release:
            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
            password.password = False if password.password is True else True

MDScreen:
    MDLabel:
        id: notification_text
        text: ""
        halign: "center"
        y: 200
        color: "#008170"
        font_name: "Quicksand"
        font_size: 24

    MDScreenManager:
        id: root_screen_manager

        MDScreen:
            name: "login"
            MDRelativeLayout:
                size_hint_x: None
                width: "300dp"
                pos_hint: {"center_x": .5, "center_y": .5}
                MDTextField:
                    id: login_user
                    icon_left: "account"
                    pos_hint: {"center_x": .5, "center_y": .60}
                    hint_text: "Username"
            PasswordField:
                id: login_password
                size_hint_x: None
                width: "300dp"
                hint_text: "Password"
                pos_hint: {"center_x": .5, "center_y": .50}
            MDRaisedButton:
                font_name: "Quicksand"
                text: "Login"
                pos_hint: {"center_x": .5, "center_y": .40}
                on_press:
                    app.run_login()
            MDRaisedButton:
                font_name: "Quicksand"
                text: "Signup"
                pos_hint: {"center_x": .5, "center_y": .30}
                on_press:
                    root_screen_manager.current = 'signup'

        MDScreen:
            name: "signup"
            MDRelativeLayout:
                size_hint_x: None
                width: "300dp"
                pos_hint: {"center_x": .5, "center_y": .5}
                MDTextField:
                    id: signup_account
                    icon_left: "account"
                    pos_hint: {"center_x": .5, "center_y": .65}
                    hint_text: "Username"
                MDTextField:
                    id: signup_email
                    icon_left: "email"
                    pos_hint: {"center_x": .5, "center_y": .55}
                    hint_text: "Email"
                    validator: "email"
                    error_color: "grey"
            PasswordField:
                id: signup_password
                size_hint_x: None
                width: "300dp"
                hint_text: "Password"
                pos_hint: {"center_x": .5, "center_y": .45}
            MDRaisedButton:
                text: "Login"
                pos_hint: {"center_x": .55, "center_y": .35}
                on_press:
                    root_screen_manager.transition.direction = 'right'
                    root_screen_manager.current = 'login'
            MDRaisedButton:
                text: "Signup"
                pos_hint: {"center_x": .45, "center_y": .35}
                on_press:
                    app.signup()
                    root_screen_manager.transition.direction = 'right'
        MDScreen:
            name: "logged"
            MDTopAppBar:
                title: screen_manager.current
                elevation: 4
                pos_hint: {"top": 1}
                md_bg_color: "232D3F"
                specific_text_color: "#008170"
                left_action_items:
                    [['menu', lambda x: nav_drawer.set_state("open")]]
                right_action_items:
                    [['logout', lambda x: app.logout()]]

            MDNavigationLayout:

            MDScreenManager:
                id: screen_manager

                MDScreen:
                    name: "Dashboard"
                    MDGridLayout:
                        cols: 1
                        rows: 6
                        adaptive_height: True
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        size_hint_x: 0.8
                        md_bg_color: "232D3F"
                        spacing: 10, 20
                        MDLabel:
                            md_bg_color: "005B41"
                            text: "Savings"
                            font_name: "Quicksand"
                            halign: "center"
                            size_hint_y: None
                            height: 50
                            font_style: "H5"
                        MDLabel:
                            id: remaining_budget
                            text: ""
                            font_name: "Quicksand"
                            size_hint_y: None
                            height: 80
                            halign: "center"
                            font_style: "H2"
                        MDLabel:
                            id: direct_saving_label
                            text: ""
                            font_name: "Quicksand"
                            halign: "center"
                            size_hint_y: None
                            height: 30
                        MDLabel:
                            md_bg_color: "005B41"
                            text: "Remaining Budgets"
                            font_name: "Quicksand"
                            halign: "center"
                            size_hint_y: None
                            height: 50
                            font_style: "H5"
                        MDGridLayout:
                            cols: 4
                            rows: 2
                            adaptive_height: True
                            pos_hint: {"center_x": 0.5, "center_y": 0.5}
                            size_hint_x: 0.8
                            md_bg_color: "232D3F"
                            MDLabel:
                                text: "Food"
                                font_name: "Quicksand"
                                halign: "center"
                                size_hint_y: None
                                height: 25
                            MDLabel:
                                text: "Travel"
                                font_name: "Quicksand"
                                halign: "center"
                                size_hint_y: None
                                height: 25
                            MDLabel:
                                text: "Utilities"
                                font_name: "Quicksand"
                                halign: "center"
                                size_hint_y: None
                                height: 25
                            MDLabel:
                                text: "Personal"
                                font_name: "Quicksand"
                                halign: "center"
                                size_hint_y: None
                                height: 25
                            MDLabel:
                                id: food_remaining_budget
                                text: ""
                                font_name: "Quicksand"
                                halign: "center"
                                size_hint_y: None
                                height: 40
                            MDLabel:
                                id: transportation_remaining_budget
                                text: ""
                                font_name: "Quicksand"
                                halign: "center"
                                size_hint_y: None
                                height: 40
                            MDLabel:
                                id: utilities_remaining_budget
                                text: ""
                                font_name: "Quicksand"
                                halign: "center"
                                size_hint_y: None
                                height: 40
                            MDLabel:
                                id: personal_remaining_budget
                                text: ""
                                font_name: "Quicksand"
                                halign: "center"
                                size_hint_y: None
                                height: 40
                        MDRaisedButton:
                            text: "Add Expense"
                            size_hint_x: 0.5
                            on_press:
                                screen_manager.transition.direction = 'left'
                                screen_manager.current = 'Add Expenses'
                    MDRaisedButton:
                        text: "Reset Expenses"
                        size_hint_x: 0.3
                        pos_hint: {"center_x": 0.5, "center_y": 0.05}
                        md_bg_color: "#232D3F"
                        on_press:
                            app.remove_expense('tmp')

                MDScreen:
                    name: "Add Expenses"
                    MDGridLayout:
                        cols: 1
                        rows: 3
                        adaptive_height: True
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        size_hint_x: 0.8
                        md_bg_color: "232D3F"
                        padding: [12,6,12,12]
                        MDTextField:
                            id: expense_amount
                            icon_right: "cash-fast"
                            pos_hint: {"center_x": .5, "center_y": .60}
                            hint_text: "Expense Amount"
                            helper_text_mode: "persistent"
                            input_filter: "float"
                        MDGridLayout:
                            id: category_drop
                            size_hint_y: None
                            cols: 1
                            rows: 1
                            MDRaisedButton:
                                id: category_dropdown_button
                                text: "Select a Category"
                                size_hint_x: 1
                                on_release: app.category_menu()
                        MDRaisedButton:
                            text: "Add Expense"
                            size_hint_x: 0.5
                            on_press:
                                app.store_expense('expense_amount')

                MDScreen:
                    name: "Manage Incomes"
                    ScrollView:
                        pos_hint: {"center_x": 0.5, "center_y": 0.45}
                        size_hint: (0.8, 0.8)
                        MDGridLayout:
                            cols: 1
                            rows: 7
                            adaptive_height: True
                            size_hint_x: 1
                            md_bg_color: "232D3F"
                            spacing: 10, 20
                            MDLabel:
                                md_bg_color: "005B41"
                                text: "Current Income"
                                font_name: "Quicksand"
                                halign: "center"
                                size_hint_y: None
                                height: 50
                                font_style: "H5"
                            MDLabel:
                                id: current_income
                                text: ""
                                font_name: "Quicksand"
                                size_hint_y: None
                                height: 80
                                halign: "center"
                                font_style: "H2"
                            MDLabel:
                                id: current_savings
                                text: "(Savings: 0%)"
                                font_name: "Quicksand"
                                halign: "center"
                                size_hint_y: None
                                height: 30
                                font_style: "H6"
                            MDGridLayout:
                                cols: 2
                                rows: 1
                                adaptive_height: True
                                size_hint_x: 1
                                md_bg_color: "232D3F"
                                MDRaisedButton:
                                    text: "Manage Savings"
                                    size_hint_x: 0.5
                                    on_press:
                                        screen_manager.transition.direction = "left"
                                        screen_manager.current = 'Manage Savings'
                                MDRaisedButton:
                                    text: "Update Income"
                                    size_hint_x: 0.5
                                    on_press:
                                        screen_manager.transition.direction = 'left'
                                        screen_manager.current = 'Update Income'
                            MDLabel:
                                md_bg_color: "005B41"
                                text: "Recurring Expenses"
                                font_name: "Quicksand"
                                halign: "center"
                                size_hint_y: None
                                height: 50
                                font_style: "H5"
                            MDGridLayout:
                                id: incomes_data_layout
                                size_hint_y: None
                                height: 250
                                cols: 1
                                rows: 1
                            MDGridLayout:
                                cols: 2
                                rows: 1
                                adaptive_height: True
                                size_hint_x: 1
                                md_bg_color: "232D3F"
                                MDRaisedButton:
                                    text: "Remove Selected"
                                    size_hint_x: 0.5
                                    on_press:
                                        app.remove_expense('recurring')
                                MDRaisedButton:
                                    text: "Add new"
                                    size_hint_x: 0.5
                                    on_press:
                                        screen_manager.transition.direction = "left"
                                        screen_manager.current = 'Add Recurring Expense'
                MDScreen:
                    name: "Update Income"
                    MDGridLayout:
                        cols: 1
                        rows: 2
                        adaptive_height: True
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        size_hint_x: 0.8
                        md_bg_color: "232D3F"
                        padding: [12,6,12,12]
                        MDTextField:
                            id: update_income
                            icon_right: "cash-fast"
                            pos_hint: {"center_x": .5, "center_y": .60}
                            hint_text: "Type Your Income"
                            helper_text_mode: "persistent"
                            input_filter: "float"
                            text: ""
                        MDGridLayout:
                            cols: 2
                            rows: 1
                            adaptive_height: True
                            size_hint_x: 1
                            md_bg_color: "232D3F"
                            MDRaisedButton:
                                text: "Back"
                                size_hint_x: 0.5
                                on_press:
                                    screen_manager.transition.direction = 'right'
                                    screen_manager.current = 'Manage Incomes'
                            MDRaisedButton:
                                text: "Update"
                                size_hint_x: 0.5
                                on_press:
                                    app.update_income()
                MDScreen:
                    name: "Manage Savings"
                    MDGridLayout:
                        cols: 1
                        rows: 2
                        adaptive_height: True
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        size_hint_x: 0.8
                        md_bg_color: "232D3F"
                        padding: [12,6,12,12]
                        MDTextField:
                            id: update_savings
                            icon_right: "cash-plus"
                            pos_hint: {"center_x": .5, "center_y": .60}
                            hint_text: "Type the % that you want to keep"
                            helper_text_mode: "persistent"
                            input_filter: "float"
                            text: ""
                        MDGridLayout:
                            cols: 2
                            rows: 1
                            adaptive_height: True
                            size_hint_x: 1
                            md_bg_color: "232D3F"
                            MDRaisedButton:
                                text: "Back"
                                size_hint_x: 0.5
                                on_press:
                                    screen_manager.transition.direction = 'right'
                                    screen_manager.current = 'Manage Incomes'
                            MDRaisedButton:
                                text: "Update"
                                size_hint_x: 0.5
                                on_press:
                                    app.update_savings()                
                MDScreen:
                    name: "Add Recurring Expense"
                    MDGridLayout:
                        cols: 1
                        rows: 2
                        adaptive_height: True
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        size_hint_x: 0.8
                        md_bg_color: "232D3F"
                        padding: [12,6,12,12]
                        MDTextField:
                            id: recurring_expense
                            icon_right: "cash-fast"
                            pos_hint: {"center_x": .5, "center_y": .60}
                            hint_text: "Insert Expense"
                            helper_text_mode: "persistent"
                            input_filter: "float"
                            text: ""
                        MDGridLayout:
                            cols: 2
                            rows: 1
                            adaptive_height: True
                            size_hint_x: 1
                            md_bg_color: "232D3F"
                            MDRaisedButton:
                                text: "Back"
                                size_hint_x: 0.5
                                on_press:
                                    screen_manager.transition.direction = 'right'
                                    screen_manager.current = 'Manage Incomes'
                            MDRaisedButton:
                                text: "Store Expense"
                                size_hint_x: 0.5
                                on_press:
                                    app.store_expense('recurring_expense')
                MDScreen:
                    name: "Manage Categories"
                    MDGridLayout:
                        cols: 1
                        rows: 6
                        adaptive_height: True
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        size_hint_x: 0.8
                        md_bg_color: "232D3F"
                        padding: [12,6,12,12]
                        MDLabel:
                            text: "The sum of these fields must be 0 or 100"
                            halign: "center"
                            size_hint_y: None
                            height: 30
                        MDTextField:
                            id: food_threshold_field
                            hint_text: "Food Category Threshold (%)"
                            helper_text_mode: "persistent"
                            input_filter: "float"
                            text: ""
                        MDTextField:
                            id: transportation_threshold_field
                            hint_text: "Travel Category Threshold (%)"
                            helper_text_mode: "persistent"
                            input_filter: "float"
                            text: ""
                        MDTextField:
                            id: utilities_threshold_field
                            hint_text: "Utilities Category Threshold (%)"
                            helper_text_mode: "persistent"
                            input_filter: "float"
                            text: ""
                        MDTextField:
                            id: personal_threshold_field
                            hint_text: "Personal Category Threshold (%)"
                            helper_text_mode: "persistent"
                            input_filter: "float"
                            text: ""
                        MDRaisedButton:
                            text: "Update"
                            size_hint_x: 0.5
                            on_press:
                                app.update_categories()
                MDScreen:
                    name: "Check Expenses"
                    MDLabel:
                        text: "Expenses"
                        halign: 'center'

            MDNavigationDrawer:
                id: nav_drawer
                radius: (0, 16, 16, 0)

                ContentNavigationDrawer:
                    screen_manager: screen_manager
                    nav_drawer: nav_drawer
                    id: main_menu